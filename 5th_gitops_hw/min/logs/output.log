@zemiel1980 ➜ /workspaces/kubernetes (main) $ export KUBECONFIG=/var/lib/kubelet/kubeconfig 
@zemiel1980 ➜ /workspaces/kubernetes (main) $ kubectl -n demo describe imageupdateautomation kbot | sed -n '/Conditions/,$p'
  Conditions:
    Last Transition Time:     2025-10-16T16:10:10Z
    Message:                  repository up-to-date
    Observed Generation:      5
    Reason:                   Succeeded
    Status:                   True
    Type:                     Ready
  Last Automation Run Time:   2025-10-16T16:31:14Z
  Last Handled Reconcile At:  2025-10-16T16:10:45Z
  Last Push Commit:           59c5a1c2abbc249538f97a75816a52ce214e2ebb
  Last Push Time:             2025-10-16T16:10:10Z
  Observed Generation:        5
  Observed Policies:
    Kbot:
      Name:                  zemiel1980/kbot-src
      Tag:                   2.2.9
  Observed Source Revision:  main@sha1:59c5a1c2abbc249538f97a75816a52ce214e2ebb
Events:
  Type     Reason              Age                 From                         Message
  ----     ------              ----                ----                         -------
  Normal   Succeeded           46m (x2 over 46m)   image-automation-controller  repository up-to-date
  Warning  GitOperationFailed  25m                 image-automation-controller  failed to update source: failed to run template from spec: template: commit message:2:29: executing "commit message" at <.Changed>: range can't iterate over {map[kbot-hr.yaml:map[{{{helm.toolkit.fluxcd.io/v2 HelmRelease} {kbot demo}}}:[{2.2.8 2.2.9 demo:kbot:tag}]]]}
  Warning  GitOperationFailed  23m (x12 over 30m)  image-automation-controller  failed to update source: failed to run template from spec: template: commit message:1:47: executing "commit message" at <.Changed>: range can't iterate over {map[kbot-hr.yaml:map[{{{helm.toolkit.fluxcd.io/v2 HelmRelease} {kbot demo}}}:[{2.2.8 2.2.9 demo:kbot:tag}]]]}
  Warning  GitOperationFailed  22m                 image-automation-controller  failed to update source: failed to push to remote: authentication required: No anonymous write access.
  Normal   Succeeded           21m                 image-automation-controller  pushed commit '59c5a1c' to branch 'main'
chore(kbot): automated image update
  Normal  Succeeded  40s (x40 over 45m)  image-automation-controller  no change since last reconciliation
@zemiel1980 ➜ /workspaces/kubernetes (main) $ kubectl -n demo get helmrelease kbot
NAME   AGE   READY   STATUS
kbot   46m   True    Helm upgrade succeeded for release demo/kbot.v2 with chart kbot@2.2.5
@zemiel1980 ➜ /workspaces/kubernetes (main) $ kubectl -n demo get pods -l app=kbot -o=jsonpath='{range .items[*]}{.metadata.name}{"  "}{range .spec.containers[*]}{.image}{"\n"}{end}{end}'
@zemiel1980 ➜ /workspaces/kubernetes (main) $ docker push zemiel1980/kbot-src:2.2.10
Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
@zemiel1980 ➜ /workspaces/kubernetes (main) $ #Докер пушнув на локальній машині
@zemiel1980 ➜ /workspaces/kubernetes (main) $ kubectl -n demo describe imageupdateautomation kbot | sed -n '/Conditions/,$p'
  Conditions:
    Last Transition Time:     2025-10-16T16:46:58Z
    Message:                  repository up-to-date
    Observed Generation:      6
    Reason:                   Succeeded
    Status:                   True
    Type:                     Ready
  Last Automation Run Time:   2025-10-16T16:48:59Z
  Last Handled Reconcile At:  2025-10-16T16:10:45Z
  Last Push Commit:           580d27765cca7673181d4ec25a3f977ab9f034c1
  Last Push Time:             2025-10-16T16:46:58Z
  Observed Generation:        6
  Observed Policies:
    Kbot:
      Name:                  zemiel1980/kbot-src
      Tag:                   2.2.10
  Observed Source Revision:  main@sha1:580d27765cca7673181d4ec25a3f977ab9f034c1
Events:
  Type     Reason              Age                 From                         Message
  ----     ------              ----                ----                         -------
  Warning  GitOperationFailed  43m                 image-automation-controller  failed to update source: failed to run template from spec: template: commit message:2:29: executing "commit message" at <.Changed>: range can't iterate over {map[kbot-hr.yaml:map[{{{helm.toolkit.fluxcd.io/v2 HelmRelease} {kbot demo}}}:[{2.2.8 2.2.9 demo:kbot:tag}]]]}
  Warning  GitOperationFailed  41m (x12 over 47m)  image-automation-controller  failed to update source: failed to run template from spec: template: commit message:1:47: executing "commit message" at <.Changed>: range can't iterate over {map[kbot-hr.yaml:map[{{{helm.toolkit.fluxcd.io/v2 HelmRelease} {kbot demo}}}:[{2.2.8 2.2.9 demo:kbot:tag}]]]}
  Normal   Succeeded           39m                 image-automation-controller  pushed commit '59c5a1c' to branch 'main'
chore(kbot): automated image update
  Warning  GitOperationFailed  12m (x9 over 15m)    image-automation-controller  failed to update source: failed to run template from spec: template: commit message:1:47: executing "commit message" at <.Changed>: range can't iterate over {map[kbot-hr.yaml:map[{{{helm.toolkit.fluxcd.io/v2 HelmRelease} {kbot demo}}}:[{2.2.9 2.2.10 demo:kbot:tag}]]]}
  Warning  GitOperationFailed  8m54s (x3 over 39m)  image-automation-controller  failed to update source: failed to push to remote: authentication required: No anonymous write access.
  Normal   Succeeded           2m15s                image-automation-controller  pushed commit '580d277' to branch 'main'
chore(kbot): automated image update


@zemiel1980 ➜ /workspaces/kubernetes (main) $ kubectl get all -A
NAMESPACE     NAME                                               READY   STATUS      RESTARTS   AGE
demo          pod/kbot-86785989c6-mjxhw                          1/1     Running     0          7m37s
flux-system   pod/dnsdiag                                        0/2     Completed   0          79m
flux-system   pod/helm-controller-7bdfb977b9-b5jtd               1/1     Running     0          131m
flux-system   pod/image-automation-controller-75c6fc4447-kxvmt   1/1     Running     0          131m
flux-system   pod/image-reflector-controller-6c46bc565f-cqfgh    1/1     Running     0          131m
flux-system   pod/kustomize-controller-67454c8964-srvbg          1/1     Running     0          131m
flux-system   pod/notification-controller-7d8b849448-tf5qd       1/1     Running     0          131m
flux-system   pod/source-controller-db6864b9-j85b4               1/1     Running     0          131m
kube-system   pod/coredns-c7b9fc47-jdvv8                         1/1     Running     0          85m
kube-system   pod/coredns-c7b9fc47-zqsc5                         1/1     Running     0          85m

NAMESPACE     NAME                              TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)         AGE
default       service/kubernetes                ClusterIP   10.10.0.1     <none>        443/TCP         138m
demo          service/kbot                      ClusterIP   10.10.0.233   <none>        8080/TCP        65m
flux-system   service/notification-controller   ClusterIP   10.10.0.140   <none>        80/TCP          131m
flux-system   service/source-controller         ClusterIP   10.10.0.225   <none>        80/TCP          131m
flux-system   service/webhook-receiver          ClusterIP   10.10.0.235   <none>        80/TCP          131m
kube-system   service/kube-dns                  ClusterIP   10.10.0.53    <none>        53/UDP,53/TCP   86m

NAMESPACE     NAME                                          READY   UP-TO-DATE   AVAILABLE   AGE
demo          deployment.apps/kbot                          1/1     1            1           65m
flux-system   deployment.apps/helm-controller               1/1     1            1           131m
flux-system   deployment.apps/image-automation-controller   1/1     1            1           131m
flux-system   deployment.apps/image-reflector-controller    1/1     1            1           131m
flux-system   deployment.apps/kustomize-controller          1/1     1            1           131m
flux-system   deployment.apps/notification-controller       1/1     1            1           131m
flux-system   deployment.apps/source-controller             1/1     1            1           131m
kube-system   deployment.apps/coredns                       2/2     2            2           85m

NAMESPACE     NAME                                                     DESIRED   CURRENT   READY   AGE
demo          replicaset.apps/kbot-755bf444b8                          0         0         0       44m
demo          replicaset.apps/kbot-7fff54c6d9                          0         0         0       65m
demo          replicaset.apps/kbot-86785989c6                          1         1         1       7m37s
flux-system   replicaset.apps/helm-controller-7bdfb977b9               1         1         1       131m
flux-system   replicaset.apps/image-automation-controller-75c6fc4447   1         1         1       131m
flux-system   replicaset.apps/image-reflector-controller-6c46bc565f    1         1         1       131m
flux-system   replicaset.apps/kustomize-controller-67454c8964          1         1         1       131m
flux-system   replicaset.apps/notification-controller-7d8b849448       1         1         1       131m
flux-system   replicaset.apps/source-controller-db6864b9               1         1         1       131m
kube-system   replicaset.apps/coredns-c7b9fc47                         2         2         2       85m